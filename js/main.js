document.addEventListener("DOMContentLoaded",(()=>{const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))}))}),{threshold:.2});document.querySelectorAll(".fade-in, .fade-in-up").forEach((t=>{e.observe(t)}));let t=!1;window.addEventListener("scroll",(()=>{t||(window.requestAnimationFrame((()=>{document.querySelectorAll(".parallax").forEach((e=>{const t=parseFloat(e.getAttribute("data-speed"))||.5,a=window.pageYOffset*t;e.style.backgroundPositionY=-a+"px"})),t=!1})),t=!0)})),window.toggleParallaxDebug=()=>{document.querySelectorAll(".parallax").forEach((e=>{e.style.outline=e.style.outline?"":"2px dashed red"}))},document.querySelectorAll(".col-md-4").forEach((e=>{e.addEventListener("mouseenter",(()=>{e.classList.add("shadow-lg","bg-light")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("shadow-lg","bg-light")}))})),document.querySelectorAll(".accordion-button").forEach((e=>{e.addEventListener("click",(()=>{const t="true"===e.getAttribute("aria-expanded");document.querySelectorAll(".accordion-button").forEach((e=>{e.setAttribute("aria-expanded","false"),e.classList.add("collapsed")})),t||(e.setAttribute("aria-expanded","true"),e.classList.remove("collapsed"))}))}));const a=document.querySelector("form");a&&a.addEventListener("submit",(e=>{e.preventDefault();const t=a.querySelector("#nombre"),o=a.querySelector("#email"),s=a.querySelector("#mensaje");let n=[];document.querySelectorAll(".error-msg").forEach((e=>e.remove())),a.querySelectorAll(".is-invalid").forEach((e=>e.classList.remove("is-invalid")));const r=a.querySelector(".success-msg");if(r&&r.remove(),(!t.value.trim()||t.value.trim().length<3)&&n.push({field:t,message:"El nombre debe tener al menos 3 caracteres."}),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.value.trim())||n.push({field:o,message:"Ingresa un correo electrónico válido."}),(!s.value.trim()||s.value.trim().length<10)&&n.push({field:s,message:"El mensaje debe tener al menos 10 caracteres."}),n.length>0)return void n.forEach((e=>{const t=document.createElement("div");t.className="error-msg text-danger small mt-1 fade-in",t.textContent=e.message,e.field.classList.add("is-invalid"),e.field.parentNode.appendChild(t)}));const l=document.createElement("div");l.className="success-msg alert alert-success mt-3 fade-in",l.textContent="✅ Mensaje enviado correctamente. Nos pondremos en contacto.",a.appendChild(l),a.reset()}));const o=document.getElementById("cookie-modal"),s=document.getElementById("accept-cookies");o&&s&&(localStorage.getItem("cookies_aceptadas")||(o.classList.add("show"),setTimeout((()=>{o.classList.contains("show")&&o.classList.remove("show")}),1e4)),s.addEventListener("click",(()=>{localStorage.setItem("cookies_aceptadas","true"),o.classList.remove("show");const e=document.createElement("script");e.setAttribute("async",""),e.src="https://www.googletagmanager.com/gtag/js?id=G-MJQBRLE59Y",document.head.appendChild(e),window.dataLayer=window.dataLayer||[],window.dataLayer.push({js:new Date}),window.dataLayer.push({config:"G-MJQBRLE59Y"})})));const n=document.querySelectorAll(".navbar-nav .nav-link"),r=document.getElementById("mainNavbar");n&&r&&n.forEach((e=>{e.addEventListener("click",(()=>{r.classList.contains("show")&&new bootstrap.Collapse(r).toggle()}))})),new Promise((e=>{const t=new Image;t.onload=()=>e(t.width>0&&t.height>0),t.onerror=()=>e(!1),t.src="data:image/webp;base64,UklGRhIAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSAIAAAARAAEAAQAAAFQAAABwAAQAAwAA"})).then((e=>{e&&document.querySelectorAll("img[data-webp]").forEach((e=>{e.src=e.dataset.webp}))}))})),document.addEventListener("mouseout",(function(e){if(e.clientY<50&&!localStorage.getItem("exitIntentShown")){localStorage.setItem("exitIntentShown","true");const e=document.getElementById("exit-intent-modal");e&&e.classList.add("show")}})),setTimeout((()=>{const e=document.getElementById("whatsapp-button");e&&(e.style.display="block")}),2e4);