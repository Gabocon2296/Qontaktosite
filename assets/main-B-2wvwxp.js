document.addEventListener("DOMContentLoaded",(()=>{const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))}))}),{threshold:.2});document.querySelectorAll(".fade-in, .fade-in-up").forEach((t=>{e.observe(t)}));let t=!1;window.addEventListener("scroll",(()=>{t||(window.requestAnimationFrame((()=>{document.querySelectorAll(".parallax").forEach((e=>{const t=parseFloat(e.getAttribute("data-speed"))||.5,a=window.pageYOffset*t;e.style.backgroundPositionY=-a+"px"})),t=!1})),t=!0)})),window.toggleParallaxDebug=()=>{document.querySelectorAll(".parallax").forEach((e=>{e.style.outline=e.style.outline?"":"2px dashed red"}))},document.querySelectorAll(".col-md-4").forEach((e=>{e.addEventListener("mouseenter",(()=>{e.classList.add("shadow-lg","bg-light")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("shadow-lg","bg-light")}))})),document.querySelectorAll(".accordion-button").forEach((e=>{e.addEventListener("click",(()=>{const t="true"===e.getAttribute("aria-expanded");document.querySelectorAll(".accordion-button").forEach((e=>{e.setAttribute("aria-expanded","false"),e.classList.add("collapsed")})),t||(e.setAttribute("aria-expanded","true"),e.classList.remove("collapsed"))}))}));const a=document.querySelector("form");a&&a.addEventListener("submit",(e=>{e.preventDefault();const t=a.querySelector("#nombre"),s=a.querySelector("#email"),o=a.querySelector("#mensaje");let r=[];document.querySelectorAll(".error-msg").forEach((e=>e.remove())),a.querySelectorAll(".is-invalid").forEach((e=>e.classList.remove("is-invalid")));const n=a.querySelector(".success-msg");n&&n.remove(),(!t.value.trim()||t.value.trim().length<3)&&r.push({field:t,message:"El nombre debe tener al menos 3 caracteres."});if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value.trim())||r.push({field:s,message:"Ingresa un correo electrónico válido."}),(!o.value.trim()||o.value.trim().length<10)&&r.push({field:o,message:"El mensaje debe tener al menos 10 caracteres."}),r.length>0)return void r.forEach((e=>{const t=document.createElement("div");t.className="error-msg text-danger small mt-1 fade-in",t.textContent=e.message,e.field.classList.add("is-invalid"),e.field.parentNode.appendChild(t)}));const l=document.createElement("div");l.className="success-msg alert alert-success mt-3 fade-in",l.textContent="✅ Mensaje enviado correctamente. Nos pondremos en contacto.",a.appendChild(l),a.reset()}));const s=document.getElementById("cookie-modal"),o=document.getElementById("accept-cookies");s&&o&&(localStorage.getItem("cookies_aceptadas")||(s.classList.add("show"),setTimeout((()=>{s.classList.contains("show")&&s.classList.remove("show")}),1e4)),o.addEventListener("click",(()=>{localStorage.setItem("cookies_aceptadas","true"),s.classList.remove("show"),function(){const e=document.createElement("script");function t(){dataLayer.push(arguments)}e.setAttribute("async",""),e.src="https://www.googletagmanager.com/gtag/js?id=G-MJQBRLE59Y ",document.head.appendChild(e),window.dataLayer=window.dataLayer||[],t("js",new Date),t("config","G-MJQBRLE59Y")}()})));const r=document.querySelectorAll(".navbar-nav .nav-link"),n=document.getElementById("mainNavbar");r&&n&&r.forEach((e=>{e.addEventListener("click",(()=>{n.classList.contains("show")&&new bootstrap.Collapse(n).toggle()}))})),new Promise((e=>{const t=new Image;t.onload=()=>e(t.width>0&&t.height>0),t.onerror=()=>e(!1),t.src="data:image/webp;base64,UklGRhIAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSAIAAAARAAEAAQAAAFQAAABwAAQAAwAA"})).then((e=>{e&&document.querySelectorAll("img[data-webp]").forEach((e=>{e.src=e.dataset.webp}))}))}));
